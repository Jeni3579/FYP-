import pandas as pd
from sklearn.ensemble import RandomForestClassifier
from sklearn.feature_extraction.text import TfidfVectorizer
from sklearn.pipeline import make_pipeline
import joblib

print("Starting Malware/Host-based AI Model Training...")
df = pd.read_csv('security_events.csv')
X = df['event_type'] + " " + df['user']
y = df['threat_category']
model_pipeline = make_pipeline(TfidfVectorizer(), RandomForestClassifier(n_estimators=100, random_state=42))
print("Training the new AI model...")
model_pipeline.fit(X, y)
print("Model training complete.")
joblib.dump(model_pipeline, 'malware_model.pkl')
print("\nNew model 'malware_model.pkl' saved successfully.")